(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22c06437"],{4463:function(e,t,n){"use strict";n("9f6b")},"9f6b":function(e,t,n){},a434:function(e,t,n){"use strict";var r=n("23e7"),i=n("23cb"),o=n("a691"),a=n("50c4"),l=n("7b0b"),s=n("65f0"),c=n("8418"),u=n("1dde"),d=n("ae40"),f=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,m=Math.min,v=9007199254740991,b="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f||!h},{splice:function(e,t){var n,r,u,d,f,h,y=l(this),g=a(y.length),R=i(e,g),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=g-R):(n=w-2,r=m(p(o(t),0),g-R)),g+n-r>v)throw TypeError(b);for(u=s(y,r),d=0;d<r;d++)f=R+d,f in y&&c(u,d,y[f]);if(u.length=r,n<r){for(d=R;d<g-r;d++)f=d+r,h=d+n,f in y?y[h]=y[f]:delete y[h];for(d=g;d>g-r+n;d--)delete y[d-1]}else if(n>r)for(d=g-r;d>R;d--)f=d+r-1,h=d+n-1,f in y?y[h]=y[f]:delete y[h];for(d=0;d<n;d++)y[d+R]=arguments[d+2];return y.length=g-r+n,u}})},aca5:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleEditRoleInfoShow()}}},[e._v(" New Role ")]),n("el-table",{attrs:{data:e.roleList,border:"","cell-style":e.cellStyle}},[n("el-table-column",{attrs:{label:"Role Key",prop:"key",width:"200"}}),n("el-table-column",{attrs:{label:"Role Name",prop:"name",width:"200"}}),n("el-table-column",{staticClass:"description",attrs:{label:"Description",prop:"description",width:"400"}}),n("el-table-column",{attrs:{label:"Operations"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,i=t.$index;return[n("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.handleEditRoleInfoShow(r)}}},[e._v(" Edit ")]),n("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(t){return e.handleRoleDelete(r,i)}}},[e._v(" Delete ")])]}}])})],1),n("el-dialog",{attrs:{visible:e.editRoleInfo.visible,title:e.editRoleInfo.title},on:{"update:visible":function(t){return e.$set(e.editRoleInfo,"visible",t)}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",{attrs:{size:"medium",type:"danger"},nativeOn:{click:function(t){e.editRoleInfo.visible=!1}}},[e._v(" Cancel ")]),n("el-button",{attrs:{size:"medium",type:"primary"},nativeOn:{click:function(t){return e.handleEditRoleConfirm(t)}}},[e._v(" Confirm ")])]},proxy:!0}])},[n("el-form",{attrs:{model:e.editRoleInfo,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"Name"}},[n("el-input",{attrs:{placeholder:"Role Name"},model:{value:e.editRoleInfo.name,callback:function(t){e.$set(e.editRoleInfo,"name",t)},expression:"editRoleInfo.name"}})],1),n("el-form-item",{attrs:{label:"Desc"}},[n("el-input",{attrs:{placeholder:"Role Description",type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.editRoleInfo.description,callback:function(t){e.$set(e.editRoleInfo,"description",t)},expression:"editRoleInfo.description"}})],1),n("el-form-item",{attrs:{label:"Menus"}},[n("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{data:e.routes,props:e.defaultProps,"show-checkbox":"","node-key":e.treeNodeKey}})],1)],1)],1)],1)},i=[],o=n("2909"),a=n("5530"),l=n("b85c"),s=n("1da1"),c=(n("96cf"),n("498a"),n("b0c0"),n("a434"),n("caad"),n("2532"),n("a4d3"),n("e01a"),n("d81d"),n("159b"),n("b64b"),n("4de4"),n("1bab"));function u(){return Object(c["a"])({url:"/routes",method:"get"})}function d(){return Object(c["a"])({url:"/roles",method:"get"})}function f(e){return Object(c["a"])({url:"/add-role",method:"post",data:e})}function h(e,t){return Object(c["a"])({url:"/role/".concat(e),method:"put",data:t})}function p(e){return Object(c["a"])({url:"/role/".concat(e),method:"delete"})}var m=n("df7c"),v=n.n(m),b={name:"RolePermission",data:function(){return{treeNodeKey:"path",defaultProps:{label:"title",children:"children"},editRoleInfo:{visible:null,title:null,name:null,description:null,menus:null,treeKey:"path"},roleList:[],routes:[],cellStyle:function(e){var t=e.column;if("Description"===t.label.trim())return{"text-align":"left"}}}},created:function(){this.getRoutes(),this.getRoles()},methods:{handleRoleDelete:function(e,t){var n=this,r=e.name,i=e.key;this.$confirm("Confirm to remove ".concat(r,"?"),"Warning",{cancelButtonText:"Cancel",confirmButtonText:"Confirm",type:"warning",callback:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==o){e.next=5;break}return e.next=3,p(i);case 3:n.roleList.splice(t,1),n.$message({type:"success",message:"delete ".concat(r," success!")});case 5:case"end":return e.stop()}}),e)})));function o(t){return e.apply(this,arguments)}return o}()})},generateRoutesByKeys:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",i=[],o=Object(l["a"])(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,c=v.a.resolve(r,s.path);if(s.children){var u=this.generateRoutesByKeys(s.children,t,c);u.length>0&&(s=Object(a["a"])(Object(a["a"])({},s),{},{children:u}),i.push(s))}else t.includes(c)&&i.push(s)}}catch(d){o.e(d)}finally{o.f()}return i},handleEditRoleInfoShow:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.$createElement,r=t.routes,i=void 0===r?[]:r,o=t.name,l=t.description,c=this.editRoleInfo;c.title=o?"Edit Role":"New Role",c.visible=!0,c.name=o,c.description=l,this.$nextTick((function(){e.$refs.tree.setCheckedKeys(i)})),this.handleEditRoleConfirm=function(){var r=t.name,i=c.name,l=c.description,u=c.title,d=function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(){var s,d,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.name=i,t.description=l,t.routes=e.$refs.tree.getCheckedKeys(!0),s=Object(a["a"])(Object(a["a"])({},t),{},{routes:e.generateRoutesByKeys(e.serviceRoutes,e.$refs.tree.getCheckedKeys())}),"New Role"!==u){r.next=13;break}return r.next=7,f(s);case 7:d=r.sent,p=d.data.key,t.key=p,e.roleList.push(t),r.next=15;break;case 13:return r.next=15,h(t.key,s);case 15:c.visible=!1,e.$notify.success({title:"Success",message:n("div",[n("div",["Role Key: ",t.key]),n("div",["Role Name: ",o]),n("div",["Description: ",l])])});case 17:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=i?n("div",[n("div",["the role with the name of ",n("strong",[i])," has existed"]),"please reedit the role name"]):"Empty Role Name is not allowed ";e.$confirm(r,"Warning",{type:"warning",showCancelButton:!1,callback:t})},m=function(){return!i||e.roleList.some((function(e){return e.name===i}))};"Edit Role"===u?r!==i&&m()?p():d():m()?p():d()}},getRoutes:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:n=t.sent,r=n.data,e.serviceRoutes=r,e.routes=e.generateRoutes(r);case 6:case"end":return t.stop()}}),t)})))()},getRoles:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d();case 2:n=t.sent,r=n.data,e.roleList=r.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{routes:e.getLeavesRouteKeys(e.generateRoutes(t.routes))})}));case 5:case"end":return t.stop()}}),t)})))()},getLeavesRouteKeys:function(e){var t=this,n=[];return e.forEach((function(e){e.children?n.push.apply(n,Object(o["a"])(t.getLeavesRouteKeys(e.children))):n.push(e[t.treeNodeKey])})),n},generateRoutes:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=[],i=Object(l["a"])(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(!o.hidden){var a=this.getSingleChild(o.children,o,n);if(a)if(Object.keys(a).length>0)r.push(a);else{var s,c={path:v.a.resolve(n,o.path),title:null===(s=o.meta)||void 0===s?void 0:s.title};c.children=this.generateRoutes(o.children,c.path),r.push(c)}}}}catch(u){i.e(u)}finally{i.f()}return r},getSingleChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r={};if(e=e.filter((function(e){return!e.hidden})),0===e.length){var i;if(t.redirect)return;r={path:v.a.resolve(n,t.path),title:null===(i=t.meta)||void 0===i?void 0:i.title}}else if(1===e.length&&!t.alwaysShow){var o;r={path:v.a.resolve(n,t.path,e[0].path),title:null===(o=e[0].meta)||void 0===o?void 0:o.title}}return r},hasAbsolutePath:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((function(e){return v.a.isAbsolute(e)}))}}},y=b,g=(n("4463"),n("2877")),R=Object(g["a"])(y,r,i,!1,null,"77e3434a",null);t["default"]=R.exports},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");var r=n("06c5");function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,a=e},f:function(){try{l||null==n["return"]||n["return"]()}finally{if(s)throw a}}}}},d81d:function(e,t,n){"use strict";var r=n("23e7"),i=n("b727").map,o=n("1dde"),a=n("ae40"),l=o("map"),s=a("map");r({target:"Array",proto:!0,forced:!l||!s},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);